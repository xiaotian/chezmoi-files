-- Prevent noisy loading during scripts
\set QUIET 1

-- Prompt: user@host:db=#
\set PROMPT1 '%n@%m:%/%R%x%# '
\set PROMPT2 '%R%# '

-- Show NULL as [NULL] instead of blank
\pset null '[NULL]'

-- Nicer table output
\pset linestyle unicode
\pset border 2

-- Auto-expand wide results (or use 'on' to always expand)
\x auto

-- Show query timing
\timing on

-- Verbose error reports
\set VERBOSITY verbose

-- Keep history per-database
\set HISTFILE ~/.psql_history-:DBNAME

-- Ignore duplicate commands in history
\set HISTCONTROL ignoredups

-- More history
\set HISTSIZE 10000

-- Tab-complete keywords in uppercase
\set COMP_KEYWORD_CASE upper

-- Rollback failed transactions automatically instead of aborting
\set ON_ERROR_ROLLBACK interactive

-- Stop on error in scripts (not interactive)
\set ON_ERROR_STOP on

-- Handy shortcuts
\set clear '\\! clear'
\set conn 'SELECT usename, application_name, client_addr, state, query FROM pg_stat_activity WHERE pid <> pg_backend_pid();'
\set locks 'SELECT pid, relation::regclass, mode, granted FROM pg_locks WHERE NOT granted;'
\set size 'SELECT relname, pg_size_pretty(pg_total_relation_size(oid)) FROM pg_class WHERE relkind = $$r$$ ORDER BY pg_total_relation_size(oid) DESC LIMIT 20;'
\set bloat 'SELECT tablename, pg_size_pretty(pg_total_relation_size(schemaname || $$.$$ || tablename)) AS size FROM pg_tables WHERE schemaname = $$public$$ ORDER BY pg_total_relation_size(schemaname || $$.$$ || tablename) DESC LIMIT 10;'
\set uptime 'SELECT now() - pg_postmaster_start_time() AS uptime;'
\set settings 'SELECT name, setting, unit, context FROM pg_settings WHERE source <> $$default$$;'

-- Done being quiet
\unset QUIET

